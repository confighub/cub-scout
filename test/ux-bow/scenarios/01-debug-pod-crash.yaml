# Scenario: Debug a crashing pod
# Core debugging journey - find and understand why a pod is failing

id: debug-pod-crash
name: Debug a crashing pod
category: debug
priority: P0
difficulty_target: easy

description: |
  User sees a pod in CrashLoopBackOff and needs to understand:
  1. Which pod is crashing
  2. Why it's crashing (error/logs)
  3. Who owns it (can I fix it or do I need to contact someone?)

personas:
  - developer      # Primary - "my app is broken"
  - sre            # Primary - "incident response"
  - platform-engineer  # Secondary - "helping a team"

preconditions:
  cluster:
    - kind
    - minikube
    - any
  has_crashing_pod: true
  gitops_tool: any

goals:
  - Find the crashing pod quickly
  - See error cause without multiple commands
  - Identify owner for escalation

entry_points:
  tui:
    description: "Using cub-agent map TUI with panel layout"
    expected_keystrokes: 2
    expected_commands: 1
    difficulty: easy
    journey:
      - step: 1
        action: "Press 'i' for Issues panel"
        expect: "Right panel shows failed deployers and unhealthy workloads with red âœ— icons"
        keystrokes: 1
      - step: 2
        action: "Press 't' for full trace view"
        expect: "Full-screen trace: select resource, see ownership chain"
        keystrokes: 1
    notes: |
      Panel TUI keeps navigation visible while showing issues summary.
      For detailed trace, 't' opens full-screen interactive trace.

  cli:
    description: "Using cub-agent CLI commands"
    expected_keystrokes: 45
    expected_commands: 2
    difficulty: medium
    journey:
      - step: 1
        command: "cub-agent map list -q 'status=CrashLoopBackOff'"
        expect: "Table of crashing pods with namespace, name, owner"
        keystrokes: 40
      - step: 2
        command: "cub-agent trace deploy/NAME -n NAMESPACE"
        expect: "Ownership chain and related error events"
        keystrokes: 35

  hub:
    description: "Using ConfigHub hierarchy TUI"
    expected_keystrokes: 12
    expected_commands: 3
    difficulty: medium
    journey:
      - step: 1
        action: "Press 'i' for Issues view"
        expect: "List of resources with issues across fleet"
        keystrokes: 1
      - step: 2
        action: "Filter or navigate to crashing pods"
        expect: "Filtered view showing only crash issues"
        keystrokes: 8
      - step: 3
        action: "Select pod, view details"
        expect: "Details with error and ownership"
        keystrokes: 2

scoring:
  discoverability:
    tui: 5  # Crash icons obvious in status view
    cli: 5  # IMPROVED: 'cub-agent map crashes' shortcut command
    hub: 4  # Issues view is labeled
  speed:
    tui: 5  # 2-3 keystrokes to find
    cli: 4  # IMPROVED: shortcut command faster than query
    hub: 4  # Few clicks to Issues
  consistency:
    tui: 4  # Matches other status checks
    cli: 4  # Query syntax is consistent
    hub: 4  # Standard hierarchy navigation
  recovery:
    tui: 5  # Easy to navigate back with Esc
    cli: 4  # Re-run with different params
    hub: 4  # Back navigation works
  delight:
    tui: 5  # Visual crash indicators, color-coded
    cli: 4  # IMPROVED: better help with examples
    hub: 4  # Clean hierarchy view

composite_scores:
  tui: 4.85   # Excellent
  cli: 4.25   # IMPROVED from 3.15: Added 'map crashes' shortcut
  hub: 4.0    # Good

notes: |
  TUI excels here because visual indicators make crashes immediately obvious.
  CLI improved with dedicated 'cub-agent map crashes' command.
  Hub provides fleet-wide view of issues.

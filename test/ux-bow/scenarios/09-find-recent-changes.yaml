# Scenario: Find what changed recently
# Incident/audit journey - temporal investigation

id: find-recent-changes
name: Find what changed recently
category: debug
priority: P1
difficulty_target: easy

description: |
  User needs to know what changed in the last hour/day.
  Common triggers:
  - Incident started at X:XX, what changed?
  - Morning check - what deployed overnight?
  - Audit - what changed this week?

  Key question: "What's different from yesterday/last hour?"

personas:
  - sre                # Primary - "incident investigation"
  - platform-engineer  # Primary - "change review"
  - security           # Secondary - "audit trail"

preconditions:
  cluster: any
  has_changes: true

goals:
  - See changes sorted by time
  - Filter to specific time range
  - Understand what changed (config vs status)

entry_points:
  tui:
    description: "Using cub-agent map TUI"
    expected_keystrokes: 2
    expected_commands: 1
    difficulty: trivial
    journey:
      - step: 1
        action: "Press 'R' for recent changes view"
        expect: "Workloads sorted by age, recent GitOps activity"
        keystrokes: 1
      - step: 2
        action: "View shows age for each resource"
        expect: "Ages shown as 5m, 2h, 3d etc."
        keystrokes: 0

  cli:
    description: "Using cub-agent map list with time filter"
    expected_keystrokes: 35
    expected_commands: 1
    difficulty: medium
    journey:
      - step: 1
        command: "cub-agent map list --since=1h"
        expect: "Resources changed in last hour"
        keystrokes: 28
      - step: 2
        command: "cub-agent map list --since=1h --sort=time"
        expect: "Sorted by modification time"
        keystrokes: 40

  hub:
    description: "Using ConfigHub hierarchy TUI with activity view"
    expected_keystrokes: 1
    expected_commands: 1
    difficulty: trivial
    journey:
      - step: 1
        action: "Press 'a' for activity view"
        expect: "See recent unit updates, worker status, target status"
        keystrokes: 1
    notes: |
      Hub TUI now has dedicated 'a' activity view showing:
      - Recent unit updates sorted by revision
      - Worker status (Ready/Disconnected)
      - Target status with provider info

scoring:
  discoverability:
    tui: 5  # 'R' key in help, dedicated Recent view
    cli: 4  # --since examples in help and tab completion
    hub: 5  # IMPROVED: 'a' key in help, dedicated Activity view
  speed:
    tui: 5  # Single keystroke shows sorted list
    cli: 4  # Tab completion for --since values
    hub: 5  # IMPROVED: Single keystroke shows activity
  consistency:
    tui: 5  # View pattern consistent with s/i/p/w/d/r
    cli: 4  # Flag pattern consistent
    hub: 5  # IMPROVED: Matches other single-key views
  recovery:
    tui: 5  # Clear filter easily
    cli: 5  # Re-run command
    hub: 5  # IMPROVED: Any key dismisses, easy to return
  delight:
    tui: 5  # Age display, GitOps activity, CLI tips
    cli: 4  # Clear time filtering examples
    hub: 5  # IMPROVED: Shows units, workers, targets with status

composite_scores:
  tui: 5.0    # Dedicated 'R' Recent view
  cli: 4.15   # --since docs and tab completion
  hub: 5.0    # IMPROVED from 3.15: Dedicated 'a' Activity view

notes: |
  All entry points now have excellent support for finding recent changes:

  TUI: 'R' key for Recent changes view
  - Shows workloads sorted by creation time (newest first)
  - Displays age as human-readable (5m, 2h, 3d)
  - Shows recent GitOps activity (sources, kustomizations)

  CLI: --since flag with examples and tab completion

  Hub: 'a' key for Activity view (NEW)
  - Shows recent unit updates sorted by revision
  - Worker status with Ready/Disconnected indicators
  - Target status with provider info

# Scenario: Check GitOps sync status
# Operational journey - understand GitOps state

id: gitops-sync-status
name: Check GitOps sync status
category: monitor
priority: P0
difficulty_target: trivial

description: |
  User wants to see if GitOps is in sync, and if not, why.
  Key questions:
  - Is everything synced?
  - What's pending/failed?
  - Why did sync fail?

personas:
  - developer          # Primary - "did my change deploy?"
  - platform-engineer  # Primary - "fleet sync status"
  - sre                # Secondary - "incident - is it sync related?"

preconditions:
  cluster: any
  gitops_tool:
    - flux
    - argocd

goals:
  - See sync status at a glance
  - Identify out-of-sync resources
  - Understand sync failure reason

entry_points:
  tui:
    description: "Using cub-agent map TUI with panel layout"
    expected_keystrokes: 1
    expected_commands: 1
    difficulty: trivial
    journey:
      - step: 1
        action: "Press 'p' for Pipelines panel or 'd' for Drift panel"
        expect: "Pipelines shows Kustomizations/HelmReleases/Applications with sync status icons; Drift shows sync percentage"
        keystrokes: 1
    notes: |
      Panel TUI keeps navigation visible while showing details.
      Pipelines panel: shows each GitOps resource with ✓/✗/⏸ status.
      Drift panel: shows sync percentage and lists drifted resources.

  cli:
    description: "Using cub-agent map gitops"
    expected_keystrokes: 20
    expected_commands: 1
    difficulty: easy
    journey:
      - step: 1
        command: "cub-agent map gitops"
        expect: "Table of GitOps sources with sync status"
        keystrokes: 18
      - step: 2
        command: "cub-agent map gitops --failed"
        expect: "Only failed/pending items"
        keystrokes: 25

  hub:
    description: "Using ConfigHub hierarchy"
    expected_keystrokes: 3
    expected_commands: 1
    difficulty: trivial
    journey:
      - step: 1
        action: "View hierarchy - sync status shown inline"
        expect: "Each unit/space shows sync indicator"
        keystrokes: 0
      - step: 2
        action: "Press 'd' for drift view"
        expect: "Resources with drift highlighted"
        keystrokes: 1

scoring:
  discoverability:
    tui: 5  # IMPROVED: 'p' Pipelines and 'd' Drift in visible nav panel
    cli: 5  # 'gitops' subcommand is clear
    hub: 5  # Sync status inline by default
  speed:
    tui: 5  # Single keystroke, stays in context with panel layout
    cli: 4  # Short command
    hub: 5  # Visible without action
  consistency:
    tui: 5  # Panel pattern consistent across all views
    cli: 5  # Subcommand pattern consistent
    hub: 5  # Status indicators consistent
  recovery:
    tui: 5  # Just press another key to switch panels
    cli: 5  # Re-run
    hub: 5  # Back navigation
  delight:
    tui: 5  # Panel layout keeps context, color-coded sync status
    cli: 4  # Clean output with status column
    hub: 5  # Fleet-wide view is powerful

composite_scores:
  tui: 5.0    # IMPROVED: Panel layout with visible navigation
  cli: 4.6    # Excellent
  hub: 5.0    # Perfect

notes: |
  Hub excels because sync status is THE primary info in hierarchy.
  TUI now uses panel layout - Pipelines and Drift panels show GitOps sync.
  Navigation stays visible, making switching between views seamless.

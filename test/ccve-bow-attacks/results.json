{
  "state": {
    "scannedAt": "2026-01-11T09:38:11.119193Z",
    "findings": [
      {
        "ccveId": "CCVE-2025-0166",
        "category": "STATE",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "attack-001-redis",
        "namespace": "flux-system",
        "condition": "Stalled=True",
        "reason": "RetriesExceeded",
        "message": "Failed to install after 1 attempt(s)",
        "duration": "52m",
        "remediation": "Check flux logs; force reconcile with flux reconcile",
        "command": "flux reconcile hr attack-001-redis -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0166",
        "category": "STATE",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "attack-003-service-a",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "DependencyNotReady",
        "message": "dependency 'flux-system/attack-003-service-b' is not ready",
        "duration": "57m",
        "remediation": "Ensure source GitRepository/HelmRepository is ready",
        "command": "flux reconcile hr attack-003-service-a -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0166",
        "category": "STATE",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "attack-003-service-b",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "DependencyNotReady",
        "message": "dependency 'flux-system/attack-003-service-a' is not ready",
        "duration": "57m",
        "remediation": "Ensure source GitRepository/HelmRepository is ready",
        "command": "flux reconcile hr attack-003-service-b -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0166",
        "category": "STATE",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "attack-005-no-reconcile",
        "namespace": "flux-system",
        "condition": "Stalled=True",
        "reason": "RetriesExceeded",
        "message": "Failed to install after 1 attempt(s)",
        "duration": "52m",
        "remediation": "Check flux logs; force reconcile with flux reconcile",
        "command": "flux reconcile hr attack-005-no-reconcile -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0166",
        "category": "STATE",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "attack-011-clobber",
        "namespace": "flux-system",
        "condition": "Stalled=True",
        "reason": "RetriesExceeded",
        "message": "Failed to install after 1 attempt(s)",
        "duration": "52m",
        "remediation": "Check flux logs; force reconcile with flux reconcile",
        "command": "flux reconcile hr attack-011-clobber -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "attack-004-substitute",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ReconciliationFailed",
        "message": "HorizontalPodAutoscaler/podinfo namespace not specified: the server could not find the requested ...",
        "duration": "2m",
        "remediation": "Check controller logs; verify RBAC permissions",
        "command": "flux reconcile ks attack-004-substitute -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "warning",
        "kind": "Kustomization",
        "name": "attack-006-stale",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ArtifactFailed",
        "message": "Source artifact not found, retrying in 30s",
        "duration": "57m",
        "remediation": "GitRepository source not ready; check source status",
        "command": "flux reconcile ks attack-006-stale -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "lite-002-empty-dir",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ArtifactFailed",
        "message": "kustomization path not found: stat /tmp/kustomization-2109433975/docs: no such file or directory",
        "duration": "31s",
        "remediation": "GitRepository source not ready; check source status",
        "command": "flux reconcile ks lite-002-empty-dir -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "lite-004-substitute",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ReconciliationFailed",
        "message": "Service/podinfo namespace not specified: the server could not find the requested resource ",
        "duration": "31s",
        "remediation": "Check controller logs; verify RBAC permissions",
        "command": "flux reconcile ks lite-004-substitute -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "lite-012-prune-race",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ReconciliationFailed",
        "message": "HorizontalPodAutoscaler/podinfo namespace not specified: the server could not find the requested ...",
        "duration": "31s",
        "remediation": "Check controller logs; verify RBAC permissions",
        "command": "flux reconcile ks lite-012-prune-race -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "lite-018-patch-noop",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ReconciliationFailed",
        "message": "HorizontalPodAutoscaler/podinfo namespace not specified: the server could not find the requested ...",
        "duration": "31s",
        "remediation": "Check controller logs; verify RBAC permissions",
        "command": "flux reconcile ks lite-018-patch-noop -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0012",
        "category": "STATE",
        "severity": "info",
        "kind": "Kustomization",
        "name": "lite-020-replacement",
        "namespace": "flux-system",
        "condition": "Ready=False",
        "reason": "ReconciliationFailed",
        "message": "HorizontalPodAutoscaler/podinfo namespace not specified: the server could not find the requested ...",
        "duration": "31s",
        "remediation": "Check controller logs; verify RBAC permissions",
        "command": "flux reconcile ks lite-020-replacement -n flux-system --with-source"
      },
      {
        "ccveId": "CCVE-2025-0662",
        "category": "SILENT",
        "severity": "critical",
        "kind": "HelmRelease",
        "name": "lite-001-valuesfrom",
        "namespace": "flux-system",
        "condition": "valuesFrom.ConfigMap=missing-config-map missing",
        "reason": "OptionalSourceMissing",
        "message": "valuesFrom references missing ConfigMap/missing-config-map with optional:true; using chart defaults",
        "duration": "",
        "remediation": "Create the ConfigMap 'missing-config-map' or remove optional:true to fail explicitly",
        "command": "kubectl get configmap missing-config-map -n flux-system"
      },
      {
        "ccveId": "CCVE-2025-0670",
        "category": "SILENT",
        "severity": "info",
        "kind": "HelmRelease",
        "name": "lite-001-valuesfrom",
        "namespace": "flux-system",
        "condition": "values+valuesFrom both set",
        "reason": "ValuesPrecedenceRisk",
        "message": "Both inline values and valuesFrom are set; inline values take precedence (may be unexpected)",
        "duration": "",
        "remediation": "Review merge order: chart defaults \u003c- valuesFrom \u003c- inline values (WINS)",
        "command": "helm get values lite-001-valuesfrom -n flux-system"
      },
      {
        "ccveId": "CCVE-2025-0665",
        "category": "SILENT",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "lite-005-interval-zero",
        "namespace": "flux-system",
        "condition": "interval=0",
        "reason": "ReconciliationDisabled",
        "message": "interval: 0 disables continuous reconciliation; drift will not be corrected",
        "duration": "",
        "remediation": "Set a non-zero interval (e.g., spec.interval: 5m) to enable reconciliation",
        "command": "kubectl patch helmrelease lite-005-interval-zero -n flux-system --type=merge -p '{\"spec\":{\"interval\":\"5m\"}}'"
      },
      {
        "ccveId": "CCVE-2025-0670",
        "category": "SILENT",
        "severity": "info",
        "kind": "HelmRelease",
        "name": "lite-011-clobber",
        "namespace": "flux-system",
        "condition": "values+valuesFrom both set",
        "reason": "ValuesPrecedenceRisk",
        "message": "Both inline values and valuesFrom are set; inline values take precedence (may be unexpected)",
        "duration": "",
        "remediation": "Review merge order: chart defaults \u003c- valuesFrom \u003c- inline values (WINS)",
        "command": "helm get values lite-011-clobber -n flux-system"
      },
      {
        "ccveId": "CCVE-2025-0671",
        "category": "SILENT",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "lite-015-wildcard",
        "namespace": "flux-system",
        "condition": "chart.version=\u003e=6.0.0",
        "reason": "VersionWildcard",
        "message": "Chart version uses wildcard/range; may get unexpected upgrades",
        "duration": "",
        "remediation": "Pin to a specific version (e.g., 1.2.3) for predictable deployments",
        "command": "kubectl get helmrelease lite-015-wildcard -n flux-system -o jsonpath='{.spec.chart.spec.version}'"
      },
      {
        "ccveId": "CCVE-2025-0672",
        "category": "SILENT",
        "severity": "warning",
        "kind": "HelmRelease",
        "name": "lite-043-timeout",
        "namespace": "flux-system",
        "condition": "timeout=10s",
        "reason": "TimeoutTooShort",
        "message": "Timeout may be too short for reliable deployments; may cause intermittent failures",
        "duration": "",
        "remediation": "Increase timeout to at least 5m for production deployments",
        "command": "kubectl patch helmrelease lite-043-timeout -n flux-system --type=merge -p '{\"spec\":{\"timeout\":\"5m\"}}'"
      }
    ],
    "summary": {
      "helmReleaseStuck": 5,
      "kustomizationStuck": 7,
      "applicationStuck": 0,
      "silentFailures": 6,
      "total": 18
    }
  }
}

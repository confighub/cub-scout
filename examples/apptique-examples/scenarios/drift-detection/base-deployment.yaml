apiVersion: v1
kind: Namespace
metadata:
  name: apptique-drift
  labels:
    app.kubernetes.io/part-of: apptique-examples
    scenario: drift-detection
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
  namespace: apptique-drift
  labels:
    app.kubernetes.io/name: frontend
    app.kubernetes.io/part-of: apptique
    # ArgoCD ownership labels (simulating ArgoCD-managed deployment)
    app.kubernetes.io/instance: apptique-drift
    argocd.argoproj.io/instance: apptique-drift
  annotations:
    # Document the expected values for drift comparison
    confighub.com/expected-replicas: "3"
    confighub.com/source: "git@github.com:confighubai/confighub-agent.git"
    confighub.com/source-path: "examples/apptique-examples/scenarios/drift-detection/base-deployment.yaml"
spec:
  # EXPECTED: 3 replicas (drift will change to 10)
  replicas: 3
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
        - name: frontend
          image: nginx:alpine
          ports:
            - containerPort: 80
          # EXPECTED: No DEBUG env var (drift will add it)
          env:
            - name: ENVIRONMENT
              value: "production"
          resources:
            requests:
              cpu: "100m"
              memory: "128Mi"
            limits:
              cpu: "200m"
              memory: "256Mi"
          readinessProbe:
            httpGet:
              path: /
              port: 80
            initialDelaySeconds: 5
            periodSeconds: 5
